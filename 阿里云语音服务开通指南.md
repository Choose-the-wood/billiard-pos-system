# 阿里云智能语音交互服务开通指南

## 🚨 当前问题
系统返回错误：`ErrCode: 40020503, ErrMsg: 'No permission!'`
这表明您的阿里云账户尚未开通智能语音交互服务。

## 📋 解决步骤

### 第一步：开通智能语音交互服务

1. **访问阿里云智能语音交互控制台**
   ```
   https://nls.console.aliyun.com/
   ```

2. **点击"立即开通"**
   - 如果是首次使用，会看到服务介绍页面
   - 点击"立即开通"按钮
   - 选择"按量付费"模式（推荐）

3. **确认开通**
   - 阅读服务协议
   - 点击"立即开通"确认

### 第二步：创建语音识别项目

1. **进入项目管理**
   - 开通服务后，进入控制台首页
   - 点击左侧菜单"项目管理"

2. **创建新项目**
   - 点击"创建项目"按钮
   - 填写项目信息：
     - 项目名称：`台球厅收银系统`
     - 应用场景：选择`通用场景`
     - 语言：`中文普通话`

3. **获取AppKey**
   - 项目创建成功后，会显示AppKey
   - **重要**：请记录下这个新的AppKey，替换当前配置中的AppKey

### 第三步：验证API权限

1. **检查AccessKey权限**
   - 访问RAM控制台：https://ram.console.aliyun.com/
   - 找到您当前使用的AccessKey对应的用户
   - 确保该用户具有以下权限之一：
     - `AliyunNlsFullAccess`（完全访问权限，推荐）
     - `AliyunNlsReadOnlyAccess`（只读权限，最低要求）

2. **如果没有权限，添加权限**
   - 在RAM控制台中，选择对应的用户
   - 点击"添加权限"
   - 搜索并添加`AliyunNlsFullAccess`权限

### 第四步：更新配置

开通服务并获得新的AppKey后，请告诉我新的AppKey，我会帮您更新`.env`文件。

## 🔍 验证步骤

完成上述步骤后，我们将进行以下验证：

1. **测试Token获取**
   ```bash
   curl -X GET http://localhost:3001/api/speech/token
   ```

2. **测试语音识别**
   - 在台球厅收银系统中测试语音功能
   - 验证语音识别是否正常工作

## 📞 如果遇到问题

如果在开通过程中遇到任何问题，请提供：
1. 具体的错误信息
2. 操作步骤截图
3. 新获得的AppKey（如果有）

我会立即为您提供针对性的解决方案。

## 💡 重要提醒

- 智能语音交互服务按使用量计费，新用户通常有免费额度
- 确保在正确的地域（建议华东1-杭州）开通服务
- AppKey是项目级别的，每个项目都有独立的AppKey